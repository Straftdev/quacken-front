<mat-card id="menu">
  <div *ngIf="statsOpen; else teams">
    <q-stat-end [stats]="es.lobbyContext?.stats"
                (closeStats)="statsOpen = false"></q-stat-end>
  </div>
  <ng-template #teams>
    <h2 style="font-size: 20px;">Team Selection</h2>
    <div id="flexmenu">
      <div class="teamwrap">
        <button mat-raised-button
                matTooltip="Defender"
                [matTooltipPosition]="'left'"
                [disabled]="!es.open || !ws.connected"
                (click)="joinTeam(0)">{{myTeam === 0 ? 'Leave' : 'Join'}}</button>
        <br>
        <p class="teamcount">Defenders: {{plural(attackers.length)}}</p>
        <div id="defenders">
          <div *ngFor="let m of defenders"
               class="lobbyPlayer"
               [class.ready]="m.message.r">
            <q-name [message]="m"></q-name>
            <img src="./assets/boats/{{links[m.message.b]}}.png"
                 [title]="boatTitles[m.message.b]">
            <span id="spawn"
                  [title]="m.message.s ? 'Ocean Spawn' : 'Island Spawn'">{{m.message.s ? 'O' : 'I'}}</span>
          </div>
        </div>
      </div>
      <div class="teamwrap">
        <button mat-raised-button
                [matTooltipPosition]="'right'"
                matTooltip="Attacker"
                [disabled]="!es.open || !ws.connected"
                (click)="joinTeam(1)">{{myTeam === 1 ? 'Leave' : 'Join'}}</button>
        <p class="teamcount">Attackers: {{plural(attackers.length)}}</p>
        <div id="attackers">
          <div *ngFor="let m of attackers"
               class="lobbyPlayer"
               [class.ready]="m.message.r">
            <q-name [message]="m"></q-name>
            <img src="./assets/boats/{{links[m.message.b]}}.png"
                 [title]="boatTitles[m.message.b]">
            <span id="spawn"
                  [title]="m.message.s ? 'Ocean Spawn' : 'Island Spawn'">{{m.message.s ? 'O' :
              'I'}}</span>
          </div>
        </div>
      </div>

      <div id="buttons">
        <button mat-raised-button
                [disabled]="!es.open"
                color="accent"
                id="ready"
                [class.cancel]="ready"
                (click)="toggleReady()">{{myBoat.isMe ? 'Close' : myTeam === 99 ? 'Spectate' : ready ? 'Not
          Ready' : 'Ready'}}</button>
        <ng-container *ngIf="es.open && ws.connected">
          <q-setting *ngIf="admin"
                     name="startNew"
                     id="start"></q-setting>
          <q-setting name="nextCadeBoat"></q-setting>
          <q-setting name="spawnSide"></q-setting>
        </ng-container>
      </div>
    </div>
  </ng-template>
</mat-card>
