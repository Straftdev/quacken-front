<div class="container noselect"
     id="hud">
  <div id="boatcontrol"
       oncontextmenu="event.preventDefault()">
    <div id="time">
      <div id="timebar"
           [style.transform]="'translateY(-' + (seconds$ | async) + 'px)'"></div>
    </div>
    <q-move-input id="moves"
                  (inputChange)="sendMoves()"
                  (unusedTokensChange)="unusedTokens = $event"
                  [input]="localBoat"
                  [kbControls]="kbControls"
                  [serverInput]="serverBoat"
                  [totalTokens]="totalTokens"
                  [dragContext]="dragContext"
                  [actions]="actions"
                  [moveKeys]="moveKeys"
                  [maxMoves]="myBoat.maxMoves"
                  [maxShots]="myBoat.maxShots"
                  [locked]="locked"></q-move-input>
    <div id="boatStats">
      <div id="damage"
           matTooltip="Damage: {{myBoat.getDamage()}}%">
        <div id="damagebar"
             [style.transform]="'translateX(' + myBoat.getDamage() + 'px)'"></div>
      </div>
      <div id="bilge"
           matTooltip="Bilge: {{lastTick.b || 0}}%">
        <div id="bilgebar"
             [style.transform]="'translateX(' + lastTick.b + 'px)'"></div>
      </div>
    </div>

    <div id="movesource"
         name="movesource">
      <mat-checkbox id="moveCheck"
                    [(ngModel)]="auto"
                    title="Auto"
                    (change)="changeWantMove()">
      </mat-checkbox>
      <div id="cannons">
        <div class="bombempty"
             [draggable]="unusedTokens.shots > 0"
             (dragstart)="dragCannon(8, 1)"
             [class.bombmove]="unusedTokens.shots > 0"></div><br>
        <span id="cannontext">{{unusedTokens.shots}}X</span>
      </div>
      <mat-radio-group [(ngModel)]="wantMove"
                       (change)="changeWantMove()">
        <div id="moveRadio">
          <mat-radio-button [style.paddingLeft]="'10px'"
                            [value]="1"
                            [disabled]="auto">
          </mat-radio-button>
          <br>
          <div class="move move1"
               [title]="tokenStrings[0]">
            <img [style.opacity]="unusedTokens.moves[0] ? 1 : 0"
                 name="left"
                 id="tile1"
                 draggable="true"
                 src="./assets/images/arrow1.png"
                 (dragstart)="drag(1)">
          </div>
          <br>
          {{unusedTokens.moves[0]}}X
        </div>
        <div>
          <mat-radio-button [style.paddingLeft]="'10px'"
                            [value]="2"
                            [disabled]="auto">
          </mat-radio-button>
          <br>
          <div class="move move2"
               [title]="tokenStrings[1]">
            <img [style.opacity]="unusedTokens.moves[1] ? 1 : 0"
                 name="forward"
                 id="tile2"
                 draggable="true"
                 src="./assets/images/arrow2.png"
                 (dragstart)="drag(2)">
          </div>
          <br>
          {{unusedTokens.moves[1]}}X
        </div>
        <div>
          <mat-radio-button [style.paddingLeft]="'10px'"
                            [value]="3"
                            [disabled]="auto">
          </mat-radio-button>
          <br>
          <div class="move move3"
               [title]="tokenStrings[2]">
            <img [style.opacity]="unusedTokens.moves[2] ? 1 : 0"
                 name="right"
                 id="tile3"
                 draggable="true"
                 src="./assets/images/arrow3.png"
                 (dragstart)="drag(3)">
          </div>
          <br>
          {{unusedTokens.moves[2]}}X
        </div>
      </mat-radio-group>
    </div>
    <button *ngIf="secondsPerTurn === 40"
            mat-icon-button
            [disabled]="!myBoat.isMe || (locked && !myBoat.moveLock)"
            id="hudReady"
            (click)="imReady()">
      <mat-icon>play_arrow</mat-icon>
    </button>

    <div id="maneuvers">
      <div *ngFor="let m of maneuvers; let i = index"
           (click)="setWantToken(i)"
           [matTooltip]="m.title + ' - ' + (unusedTokens.maneuvers[i] || 0) + '%'"
           [class.want]="wantManeuver === i"
           [class]="m.class">
        <img *ngIf="(unusedTokens.maneuvers[i] || 0) > 0"
             class="maneuver"
             draggable="true"
             (dragstart)="dragManeuver(m.id)"
             [class.usable]="(unusedTokens.maneuvers[i] || 0) >= 100"
             [style.maxHeight]="(unusedTokens.maneuvers[i] || 0) + '%'"
             src="./assets/images/arrow{{m.id}}.png">
        <img *ngIf="(unusedTokens.maneuvers[i] || 0) > 100"
             class="maneuver"
             draggable="true"
             (dragstart)="dragManeuver(m.id + 1)"
             [class.usable]="(unusedTokens.maneuvers[i] || 0) >= 200"
             [style.maxHeight]="(unusedTokens.maneuvers[i] || 0) - 100 + '%'"
             src="./assets/images/arrow{{m.id + 1}}.png">
      </div>
    </div>
  </div>

  <div *ngIf="myBoat.inSZ"
       id="disengage">
    <button mat-icon-button
            [style.color]="'rgb(125, 236, 80)'"
            matTooltip="Respawn Island"
            (click)="disengage(0)">
      <mat-icon>rowing</mat-icon>
    </button>
    <button mat-icon-button
            [style.color]="'red'"
            matTooltip="Respawn Ocean"
            (click)="disengage(1)">
      <mat-icon>rowing</mat-icon>
    </button>
  </div>
  <div id="chat">
    <q-chat [disabled]="es.open"></q-chat>
  </div>
</div>
